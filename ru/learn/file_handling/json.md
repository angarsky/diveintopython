> [!NOTE]
> Вы можете прочитать эту статью на сайте: https://diveintopython.org/ru/learn/file-handling/json

Файлы JSON получили огромную популярность благодаря их беспрепятственной совместимости с веб-системами. JSON, что означает [JavaScript Object Notation](https://en.wikipedia.org/wiki/JSON), служит легковесным форматом для обмена данными, что делает его предпочтительным выбором для веб-приложений. Python, оснащенный надежными инструментами, является отличной платформой для работы с файлами JSON. Эта статья направлена на изучение чтения, манипулирования файлами JSON и их практического применения с использованием Python. Понимание того, как использовать JSON в Python, критически важно для современной веб-разработки, анализа данных и интеграции систем.

## Импортирование Модуля JSON

Python предоставляет гибкие инструменты, которые позволяют работать с JSON.
Чтобы начать работу с файлами JSON в Python, сначала необходимо импортировать модуль `json`. Этот модуль обеспечивает Python функциональностью, специально адаптированной для работы с данными JSON.

Пример импортирования модуля JSON:

```python
import json
```

Эта функция используется для импорта файлов JSON в среду Python для дальнейшей обработки и манипуляции.

## Как Прочитать Файл JSON в Python

Чтение файлов JSON в Python включает использование функции `load()` из модуля json. Используя эту функцию, Python может без усилий считывать и загружать данные JSON из файла в свою программу.

Пример чтения файла JSON:

```python
with open('data.json') as file:
    data = json.load(file)
    print(data)
```

Этот пример показывает, как открыть файл JSON в Python и работать с ним.

## Функции Модуля JSON

Модуль `json` в Python предлагает различные функции для эффективной работы с данными JSON.

- **json.load()**: Эта функция загружает данные JSON из объекта, подобного файлу, и преобразует их в объект Python. Эта функция особенно полезна, когда вам нужно разобрать файл JSON в Python и манипулировать им в рамках вашей программы.
- **json.loads()**: json.loads() используется для разбора строки JSON и преобразования ее в объект Python.
- **json.dump()**: Функция json.dump() записывает данные Python в файл JSON.
- **json.dumps()**: json.dumps() используется для преобразования объекта Python (например, словаря) в строку в формате JSON.

## Как Загрузить JSON из Файла в Python с Использованием `json.load()`

Функция `json.load()` облегчает загрузку данных JSON из файла в объект Python. Она напрямую переводит данные в формате JSON из файла в совместимую структуру данных Python, обеспечивая легкий доступ и манипуляцию.

Пример - как загрузить файл JSON в Python:

```python
import json

# Reading JSON data from a file and loading it into Python
with open('data.json') as file:
    data = json.load(file)
    print(data)
```

## Разбор Строк JSON с Помощью `json.loads()`

`json.loads()` разбирает строку в формате JSON и преобразует ее в объект Python. Эта функция принимает на вход строку JSON и генерирует соответствующую структуру данных Python, облегчая извлечение и манипуляцию данными.

Пример - как разобрать строку JSON в Python:

```python
import json

# Parsing a JSON string into a Python object
json_string = '{"name": "John", "age": 30, "city": "New York"}'
parsed_data = json.loads(json_string)
print(parsed_data)
```

## Как  Записать в JSON в Python с Использованием `json.dump()`

Функция `json.dump()` записывает данные Python в файл JSON. Она принимает объект Python и напрямую записывает его в указанный файл в формате JSON, что подходит для хранения или передачи.

Пример записи в файл JSON:

```python
import json

# Writing Python data to a JSON file
data = {"name": "John", "age": 30, "city": "New York"}
with open('output.json', 'w') as file:
    json.dump(data, file)
```

## Преобразование Объектов Python в Строки JSON с Помощью `json.dumps()`

`json.dumps()` преобразует объект Python (например, словарь или список) в строку в формате JSON. Эта функция принимает на вход объект Python и возвращает строку JSON, представляющую объект, что позволяет эффективно обмениваться данными и сериализовать их.

Пример преобразования объекта Python в строку JSON:

```python
import json

# Converting a Python object to a JSON-formatted string
data = {'name': 'John', 'age': 30, 'city': 'New York'}
json_string = json.dumps(data)
print(json_string)
```

## Объекты Python и их Эквиваленты в Представлении JSON

В таблице показано соответствие между типами данных Python и их представлениями в формате JSON. При преобразовании объектов Python в JSON, словари и списки напрямую соответствуют объектам и массивам JSON соответственно. Аналогично, другие типы данных Python, такие как строки, целые числа, числа с плавающей точкой, булевы значения и None, соответствуют их эквивалентам в JSON.

| Объект Python  | Эквивалентное представление в JSON |
| ------------- | ------------- |
| Dictionary | Object  |
| List  | Array  |
| Tuple  | Array  |
| String  | String  |
| Integer  | Number  |
| Float  | Number  |
| True  | true  |
| False  | false  |
| None  | null  |

## Как Записать Объект JSON в Красивом Формате в Файл

Чтобы напечатать JSON в более читаемом и организованном формате, необходимо использовать флаг `pretty_print`. Этот флаг будет форматировать JSON, добавляя отступы, переносы строк и пробелы между элементами. Ниже приведены два способа записи JSON в красивом формате в файл.

```python
import json

data = {'name': 'John', 'age': 30, 'city': 'New York'}

with open('data.json', 'w') as file:
    json.dump(data, file, indent=4, sort_keys=True)
```

В этом примере мы использовали метод `json.dump()` для преобразования объекта словаря `data` в JSON и сохранения его в файл `data.json`. Мы установили параметр `indent` равным 4, чтобы добавить отступы, и параметр `sort_keys` в значение True, чтобы сортировать ключи в алфавитном порядке.

## Распространенные Ошибки с Файлами JSON

При работе с файлами JSON в Python вы можете столкнуться с распространенными ошибками, которые могут повлиять на загрузку, разбор и обработку данных JSON. Одна из таких ошибок - это `ValueError: Extra data error`. Эта ошибка возникает, когда в файле JSON присутствуют дополнительные данные, несовместимые с ожидаемой структурой JSON.

Первый пример - загрузка JSON с дополнительными данными:

```python
import json

data = '{"name": "John", "age": 25} {"name": "Alice", "age": 30}'

try:
    json_data = json.loads(data)
    print(json_data)
except ValueError as e:
    print("Error:", str(e))
```

В этом примере переменная `data` содержит два объекта JSON, разделенных пробелом. Когда мы пытаемся загрузить эти данные с использованием `json.loads()`, возникает `ValueError` с сообщением `Extra data`, потому что несколько объектов JSON не допустимы в одном JSON-файле.

Второй пример чтения JSON-файла с дополнительными данными:

```python
import json

try:
    with open("data.json", "r") as file:
        json_data = json.load(file)
        print(json_data)
except ValueError as e:
    print("Error:", str(e))
```

В этом примере мы читаем данные JSON из файла под названием `data.json`. Если файл содержит дополнительные данные, которые не соответствуют ожидаемой структуре JSON, метод `json.load()` вызовет `ValueError`.

Чтобы обработать `ValueError: Extra data error`, вы можете перехватить исключение, используя блок try-except, как показано в примерах. Это позволяет вам изящно обработать ошибку и предоставить соответствующую обратную связь или предпринять альтернативные действия.

При возникновении этой ошибки важно тщательно проверить файл JSON на его валидность. Убедитесь, что структура JSON корректна и в нем нет дополнительных или неожиданных данных.